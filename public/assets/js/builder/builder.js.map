{"version":3,"sources":["appFilters.js","appController.js","app.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"builder.js","sourcesContent":["angular.module('app.filters', ['ngSanitize']).filter('trustAsHtml', trustAsHTMLFilter);\r\n\r\nangular.module('app.filters').filter('assetURL', assetURLFilter);\r\n\r\nangular.module('app.filters').filter('basename', basenameFilter);\r\n\r\nangular.module('app.filters').filter('orderObjectBy', orderObjectByFilter);\r\n\r\nfunction trustAsHTMLFilter($sce) {\r\n  return $sce.trustAsHtml;\r\n}\r\n\r\nfunction assetURLFilter() {\r\n  return function(input) {\r\n      return getAssetURL(input);\r\n  }\r\n}\r\n\r\nfunction basenameFilter() {\r\n  return function(input) {\r\n      var valArr = input.split(\"/\");\r\n      var val = valArr[(valArr.length) - 1];\r\n      return val;\r\n  }\r\n}\r\n\r\nfunction orderObjectByFilter() {\r\n  return function(items, field, reverse) {\r\n    var filtered = [];\r\n    angular.forEach(items, function(item) {\r\n      filtered.push(item);\r\n    });\r\n    filtered.sort(function (a, b) {\r\n      return (a[field] > b[field] ? 1 : -1);\r\n    });\r\n    if(reverse) filtered.reverse();\r\n    return filtered;\r\n  };\r\n}\r\n","angular.module('app.controllers', []).controller('edmController', edmController);\r\n\r\nfunction edmController($scope, $compile, $window) {\r\n\r\n    // EDM Data\r\n    $scope.edm = getScopeValues();\r\n\r\n    $scope.edm.changed = false;\r\n\r\n    $scope.edm.assetManagerURL                = getAssetManagerURL();\r\n\r\n    $scope.edm.previewURL                     = getPreviewURL();\r\n\r\n    $scope.edm.componentDefaultsURL           = getTemplateURL('/common/componentDefaults.html');\r\n\r\n    $scope.edm.componentFontFamilyOptionsURL  = getTemplateURL('/common/componentFontFamilyOptions.html');\r\n\r\n    //--------------------------------------------------------------------------\r\n    //=> Custom Watches\r\n    //--------------------------------------------------------------------------\r\n\r\n    var edmStatusWatcher = $scope.$watch('edm', function(oldVal, newVal) {\r\n                          if(oldVal != newVal) {\r\n                            $scope.edm.changed = true;\r\n                            edmStatusWatcher(); // De-register `this` watcher\r\n                          }\r\n                        }, true);\r\n\r\n    //--------------------------------------------------------------------------\r\n\r\n\r\n    //--------------------------------------------------------------------------\r\n    //=> Common\r\n    //--------------------------------------------------------------------------\r\n\r\n\r\n      // Save the EDM\r\n      $scope.edm.save = function() {\r\n        $(\"#edm_save_form\").submit();\r\n        return false;\r\n      };\r\n\r\n      // Do Template Compilation\r\n      $scope.edm.doCompile = function(scope, template) {\r\n        var template = template;\r\n        var linkFn = $compile(template);\r\n        var element = linkFn(scope);\r\n        return element;\r\n      };\r\n\r\n      // Show Properties of a Component\r\n      $scope.edm.showProperties = function(template) {\r\n        var element = $scope.edm.doCompile($scope, template);\r\n        $(\"#edm-properties\").html(element);\r\n        return false;\r\n      };\r\n\r\n    //--------------------------------------------------------------------------\r\n\r\n\r\n    //--------------------------------------------------------------------------\r\n    //=> Helpers\r\n    //--------------------------------------------------------------------------\r\n\r\n\r\n    //--------------------------------------------------------------------------\r\n\r\n    //--------------------------------------------------------------------------\r\n    //=> Core Functionality\r\n    //--------------------------------------------------------------------------\r\n\r\n      // Add a Component\r\n      $scope.edm.addComponent = function(template) {\r\n\r\n        if(template == 'banner' || template == 'text' || template == 'rich-text' || template == 'image-bullet') {\r\n          $scope.edm.lastComponentId++;\r\n          var lastComponentId = $scope.edm.lastComponentId;\r\n          var totalComponents = $scope.edm.totalComponents;\r\n\r\n          var newComponent = getComponentData(template, lastComponentId, totalComponents);\r\n          if(newComponent != \"\") {\r\n            $scope.edm.components[lastComponentId] = newComponent;\r\n\r\n            $scope.edm.totalComponents++;\r\n          } else {\r\n            $scope.edm.lastComponentId--;\r\n            alert(\"Invalid Component\");\r\n          }\r\n        }\r\n        else {\r\n          alert(\"ToDo\");\r\n        }\r\n\r\n      };\r\n\r\n      // Delete a Component\r\n      $scope.edm.deleteComponent = function(id) {\r\n          if(confirm(\"Are you sure to delete this component?\")) {\r\n            var currentOrderId = $scope.edm.components[id].order;\r\n            delete $scope.edm.components[id];\r\n\r\n            $scope.edm.totalComponents--;\r\n\r\n            if($scope.edm.totalComponents < 0) {\r\n              $scope.edm.totalComponents = 0;\r\n            }\r\n\r\n            angular.forEach($scope.edm.components, function(component) {\r\n              if(component.order > currentOrderId) {\r\n                component.order = component.order - 1;\r\n              }\r\n            });\r\n\r\n            $scope.edm.showProperties('<rgedm-edm-component-properties></rgedm-edm-component-properties>');\r\n            alert(\"Component \" + id + \" Deleted\");\r\n          }\r\n      };\r\n\r\n      // Move Up a Component\r\n      $scope.edm.moveUp = function(orderId) {\r\n        var currentOrderId  = orderId;\r\n        var prevOrderId     = orderId - 1;\r\n\r\n        angular.forEach($scope.edm.components, function(component) {\r\n          if(component.order == currentOrderId) {\r\n              component.order = prevOrderId;\r\n          }\r\n          else if(component.order == prevOrderId) {\r\n            component.order = currentOrderId;\r\n          }\r\n        });\r\n      };\r\n\r\n      // Move Down a Component\r\n      $scope.edm.moveDown = function(orderId) {\r\n          var currentOrderId  = orderId;\r\n          var nextOrderId     = orderId + 1;\r\n\r\n          angular.forEach($scope.edm.components, function(component) {\r\n            if(component.order == currentOrderId) {\r\n                component.order = nextOrderId;\r\n            }\r\n            else if(component.order == nextOrderId) {\r\n              component.order = currentOrderId;\r\n            }\r\n          });\r\n      };\r\n\r\n    //--------------------------------------------------------------------------\r\n\r\n}\r\n","angular.module('edmApp', [ 'app.filters', 'app.controllers', 'app.components', 'colorpicker.module', 'cfp.hotkeys', 'rgEdmRichTextEditor.module' ]);\n\n//--------------------------------------------------------------------------\n//=> App:: jQuery\n//--------------------------------------------------------------------------\n\n$(window).ready(function() {\n  $(\"#edm-document\").trigger(\"click\");\n});\n$(document).ready(function() {\n  $(\"body\").on(\"click\", \".edm-component\", function() {\n      $(\".edm-component\").removeClass(\"active\");\n      $(this).addClass(\"active\");\n  });\n\n  $(\"body\").on(\"click\", \".toolbox-toggler\", function() {\n      $(\"#edm-components\").toggleClass(\"active\");\n  });\n\n  // var windowHeight = $(window).outerHeight();\n  //\n  // $(window).resize(function() {\n  //   if(windowHeight != $(window).outerHeight()) {\n  //       windowHeight = $(window).outerHeight();\n  //       $(\"#edm-builder #edm-document\").height(windowHeight-180);\n  //       $(\"#edm-properties .panel-body\").height(windowHeight-150);\n  //   }\n  // });\n});\n\n//--------------------------------------------------------------------------\n\n\n//--------------------------------------------------------------------------\n//=> App:: Functions\n//--------------------------------------------------------------------------\n\nfunction getCurrentScopeValues() {\n\tvar html = $(\"#edm-document\").html();\n\tvar scope_values = angular.toJson($('#edit-edm').scope().edm);\n\t$(\"#form_html\").val(html);\n\t$(\"#form_scope_values\").val(scope_values);\n\treturn true;\n}\n\n//--------------------------------------------------------------------------\n\n//--------------------------------------------------------------------------\n//=> EDM:: Functions\n//--------------------------------------------------------------------------\n\n// Get Asset URL\nfunction getAssetURL(path) {\n  return '/user/edm/front-end-asset?path=' + path;\n}\n\n// Get Template URL\nfunction getTemplateURL(path) {\n  return '/user/edm/front-end-template?path=' + path;\n}\n\n// Get Banner Component Data\nfunction getComponentData(componentName, id, orderId) {\n  var data = '';\n  switch(componentName) {\n    case 'banner':\n      data =  {\n        \"order\": orderId,\n        \"directiveName\": \"<rgedm-banner-component id=\\\"\" + id + \"\\\" edm=\\\"edm\\\"></rgedm-banner-component>\",\n        \"properties\": {\n            \"haveLink\": false,\n            \"linkURL\": \"\",\n            \"src\": \"images/header.jpg\",\n            \"alt\": \"Making your world safer!\",\n            \"title\": \"Making your world safer!\",\n            \"paddingTop\": 0,\n            \"paddingBottom\": 0\n          }\n      };\n      break;\n    case 'text':\n      data =  {\n        \"order\": orderId,\n        \"directiveName\": \"<rgedm-text-component id=\\\"\" + id + \"\\\" edm=\\\"edm\\\"></rgedm-text-component>\",\n        \"properties\": {\n            \"fontWeight\": \"normal\",\n            \"fontStyle\": \"normal\",\n            \"textDecoration\": \"none\",\n            \"fontFamily\": \"Arial\",\n            \"fontColor\": \"#000000\",\n            \"fontSize\": 12,\n            \"backgroundColor\": \"#ffffff\",\n            \"paddingTop\": 0,\n            \"paddingBottom\": 0,\n            \"paddingLeft\": 0,\n            \"paddingRight\": 0,\n            \"borderTopStyle\": 'solid',\n            \"borderBottomStyle\": 'solid',\n            \"borderLeftStyle\": 'solid',\n            \"borderRightStyle\": 'solid',\n            \"borderTopColor\": 'none',\n            \"borderBottomColor\": 'none',\n            \"borderLeftColor\": 'none',\n            \"borderRightColor\": 'none',\n            \"borderTopWidth\": 0,\n            \"borderBottomWidth\": 0,\n            \"borderLeftWidth\": 0,\n            \"borderRightWidth\": 0,\n            \"content\":\"New Text Component\",\n            \"textAlign\": \"left\"\n          }\n      };\n      break;\n    case 'rich-text':\n      data =  {\n        \"order\": orderId,\n        \"directiveName\": \"<rgedm-rich-text-component id=\\\"\" + id + \"\\\" edm=\\\"edm\\\"></rgedm-rich-text-component>\",\n        \"properties\": {\n            \"fontFamily\": \"Arial\",\n            \"fontColor\": \"#000000\",\n            \"fontSize\": 12,\n            \"backgroundColor\": \"#ffffff\",\n            \"paddingTop\": 0,\n            \"paddingBottom\": 0,\n            \"paddingLeft\": 0,\n            \"paddingRight\": 0,\n            \"content\":\"New Rich Text Component\"\n          }\n      };\n      break;\n    case 'image-bullet':\n      data =  {\n        \"order\": orderId,\n        \"directiveName\": \"<rgedm-image-bullet-component id=\\\"\" + id + \"\\\" edm=\\\"edm\\\"></rgedm-image-bullet-component>\",\n        \"properties\": {\n            \"fontFamily\": \"Arial\",\n            \"fontColor\": \"#000000\",\n            \"fontSize\": 12,\n            \"backgroundColor\": \"#ffffff\",\n            \"paddingTop\": 0,\n            \"paddingBottom\": 0,\n            \"paddingLeft\": 0,\n            \"paddingRight\": 0,\n            \"title\":\"Title\",\n            \"bullets\": [\n              \"Point 1\",\n              \"Point 2\"\n            ]\n          }\n      };\n      break;\n  }\n\n  return data;\n\n}\n\n//--------------------------------------------------------------------------\n"],"sourceRoot":"/source/"}